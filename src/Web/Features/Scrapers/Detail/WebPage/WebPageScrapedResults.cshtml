@page
@using MrWatchdog.Core.Resources
@using MrWatchdog.Web.Features.Shared
@model WebPageScrapingResultsModel
@{
   Layout = null;
}
<!turbo-frame id="scraper_web_page_scraping_results_@(Model.ScraperWebPageScrapingResults.ScraperWebPageId)">
    <div class="mb-3" 
         @Stimulus.Controller(
             StimulusControllers.ScrapersDetailWebPageScrapingResults, 
             new WebPageScrapingResultsStimulusModel($"{Model.ScraperWebPageScrapingResults.ScrapedOn:o}")
         )
         >
        <div class="d-flex justify-content-between">
            <label class="form-label fw-bold">@Resource.ScrapedResults</label>
            <form asp-page-handler="ScrapeScraperWebPage"
                  asp-route-scraperId="@Model.ScraperId"
                  asp-route-scraperWebPageId="@Model.ScraperWebPageId"
                  style="display: inline"
                  data-scrapers--detail-web-page-scraping-results-target="scrapeWebPageForm"
            >
                <button type="submit" 
                        class="btn btn-outline-primary"
                        >
                    @Resource.ScrapeWebPage
                </button>
            </form>
        </div>
        <div>
            @if (Model.ScraperWebPageScrapingResults.ScrapingResults.Any())
            {
                <div style="max-height:360px; overflow-y:auto;">
                    <ul translate="no">
                        @foreach (var scrapingResults in Model.ScraperWebPageScrapingResults.ScrapingResults)
                        {
                            <li>
                                @Html.Raw(scrapingResults)
                            </li>
                        }
                    </ul>
                </div>
            }
            else
            {
                <span class="text-danger">
                    @if (Model.ScraperWebPageScrapingResults.ScrapingErrorMessage != null)
                    {
                        @Resource.Error@:: @Model.ScraperWebPageScrapingResults.ScrapingErrorMessage
                    }
                    else
                    {
                        @Resource.WebPageNotScrapedYet
                    }
                </span>
            }
        </div>
        @if (Model.ScraperWebPageScrapingResults.ScrapedOn != null)
        {
            <div class="mt-3">
                @Resource.ScrapedOn: <span data-scrapers--detail-web-page-scraping-results-target="scrapedOnInBrowserLocale"></span>
            </div>
        }
    </div>
</!turbo-frame>

