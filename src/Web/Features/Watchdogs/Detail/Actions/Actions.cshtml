@page "{watchdogId}"
@using MrWatchdog.Core.Features.Watchdogs
@using MrWatchdog.Core.Features.Watchdogs.Domain
@using MrWatchdog.Core.Resources
@using MrWatchdog.Web.Features.Shared
@using MrWatchdog.Web.Features.Shared.ReinforcedTypings
@using MrWatchdog.Web.Infrastructure.Authorizations
@model ActionsModel
@{
    Layout = null;
}
<!turbo-frame id="watchdog_detail_actions_@(Model.WatchdogDetailPublicStatusArgs.WatchdogId)">
<div @Stimulus.Controller(StimulusControllers.WatchdogsDetailActions)
     >
    <a href="@WatchdogUrlConstants.WatchdogScrapingResultsUrlTemplate.WithWatchdogId(Model.WatchdogDetailPublicStatusArgs.WatchdogId)" 
       class="btn btn-outline-primary text-decoration-none"
       data-turbo-frame="_top">
        @Resource.ViewScrapingResults
    </a>
        @{
            var isRequestToMakePublicFormVisible = !User.IsSuperAdmin()
                                                   && Model.WatchdogDetailPublicStatusArgs.PublicStatus == PublicStatus.Private;
    }
    <form asp-page-handler="RequestToMakePublic"
          asp-route-watchdogId="@Model.WatchdogDetailPublicStatusArgs.WatchdogId"
          method="post"
          data-watchdogs--detail-actions-target="requestToMakePublicForm"
          style="display:@(!isRequestToMakePublicFormVisible ? "none" : "inline")"
    >
        <button class="btn btn-outline-primary"
                type="submit"
        >
            @Resource.RequestToMakePublic
        </button>
    </form>
    @{
        var isMakePublicFormVisible = User.IsSuperAdmin()
                                      && Model.WatchdogDetailPublicStatusArgs.PublicStatus != PublicStatus.Public;
    }
    <form asp-page-handler="MakePublic"
          asp-route-watchdogId="@Model.WatchdogDetailPublicStatusArgs.WatchdogId"
          method="post"
          data-watchdogs--detail-actions-target="makePublicForm"
          style="display:@(!isMakePublicFormVisible ? "none" : "inline")"
    >
        <button class="btn btn-outline-primary"
                type="submit"
        >
            @Resource.MakePublic
        </button>
    </form>
    @{
        var isMakePrivateFormVisible = Model.WatchdogDetailPublicStatusArgs.PublicStatus == PublicStatus.Public;
    }
    <form asp-page-handler="MakePrivate"
          asp-route-watchdogId="@Model.WatchdogDetailPublicStatusArgs.WatchdogId"
          method="post"
          data-watchdogs--detail-actions-target="makePrivateForm"
          style="display:@(!isMakePrivateFormVisible ? "none" : "inline")"
    >
        <button class="btn btn-outline-primary"
                type="submit"
                >
            Make private
        </button>
    </form>
</div>
</!turbo-frame>